; ============================================================
;  Teensy 4.1 — Multi-Environment Setup
; ============================================================

[env] 
platform = teensy
board = teensy41
framework = arduino

; Common flags
build_flags =
    -DUSB_SERIAL
    -D__IMXRT1062__
    -DARDUINO_TEENSY41
    -mcpu=cortex-m7
    -mfpu=fpv5-sp-d16
    -mfloat-abi=hard
    -mthumb
    -fno-unwind-tables
    -fno-asynchronous-unwind-tables


; ============================================================
; 1) RELEASE — Max performance
; ============================================================
[env:release]
extends = env
build_flags =
    ${env.build_flags}
    -O3
    -ffast-math
    -funsafe-math-optimizations
    -funroll-loops
    -fno-exceptions


; ============================================================
; 2) SAFE_MATH — High performance, but IEEE-correct math
; ============================================================
[env:safe_math]
extends = env
build_flags =
    ${env.build_flags}
    -O3
    -funroll-loops
    -fno-exceptions


; ============================================================
; 3) DEBUG — Usable with breakpoints & stepping
; ============================================================
[env:debug]
extends = env
build_type = debug
build_flags =
    ${env.build_flags}
    -Og
    -g3
    -fno-exceptions


; ============================================================
; 4) SIZE_OPT — Optimize for smallest firmware (not fastest)
; ============================================================
[env:size_opt]
extends = env
build_flags =
    ${env.build_flags}
    -Os
    -fdata-sections
    -ffunction-sections
    -Wl,--gc-sections
